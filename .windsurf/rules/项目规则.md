---
trigger: always_on
---

---
trigger: always_on
---

# DeepAnalyze 项目工作空间规则

## 适用范围
- 适用对象：[d:/Python-Learning/deepanalyze/](cci:7://file:///d:/Python-Learning/deepanalyze:0:0-0:0) 工作区及与 Cascade 的所有对话。
- 语言要求：与 Cascade 的交流、文档、代码注释统一使用中文。

## 核心原则
1. **禁止伪造数据**  
   - 数据缺失或模型未返回结果时，必须显式报错或返回空结果，禁止自造“示例数据”。
2. **结论需可追溯**  
   - 给出的建议或推论需指出来源：代码片段、README、官方文档等。
3. **版本透明**  
   - 涉及模型、依赖或接口版本时需明确写明（如 `vllm>=0.8.5`、`Python 3.12`）。

## 代码与文档规范
- 注释、README 需说明用途、依赖和运行方式。
- 导入顺序遵循：标准库 → 第三方 → 项目内部。
- 采用类型提示，关键函数提供 docstring。
- Markdown/README 中引用代码务必加语言标识（如 ```python）。

## 配置与敏感信息
- API 地址、密钥、模型路径等集中放入 `.env` 或配置文件，禁止硬编码。
- 若需新增配置，先更新 `.env.example` 并在 README 中标注用途。
- 与本地 vLLM 服务有关的端口/URL 需通过配置读取，不写死。

## 依赖与环境
- 默认运行环境：`conda create -n deepanalyze python=3.12`，所有依赖通过 `pip install -r requirements.txt` 安装。
- 训练相关依赖在 `deepanalyze/ms-swift`、`deepanalyze/SkyRL` 目录下以 `pip install -e .` 安装，建议单独环境。
- 禁止在系统全局环境安装依赖；新增依赖必须同步更新 `requirements.txt` 或对应子模块配置。

## 日志与异常
- 推介使用标准 `logging` 或已有工具记录日志，禁止裸 `print`。
- 捕获异常时记录上下文信息，必要时重新抛出，并给出可定位的提示。

## 数据与工作区
- `workspace` 目录需保持可复现：数据文件命名、结构、README 说明都应清晰。
- 运行 `DeepAnalyzeVLLM.generate` 前确保对应数据文件存在于 workspace，禁止在代码中临时写入“示例数据”。

## 测试与示例
- 示例脚本放在 `example/` 下；若新增示例需说明：
  - 模型/权重路径
  - 数据来源
  - 运行命令
- 建议为关键逻辑（如 prompt 解析、代码执行流程）补充单元测试或 smoke tests。

## Git 与提交
- 提交信息使用中文，格式建议 `[类型] 简述`（如 `[文档] 更新项目规则`）。
- 避免一次提交包含互不相关的修改；涉及配置/文档更新时需说明原因。

## 变更流程
1. 评估：确认需求是否已有实现或脚本（先查 README / example / deepanalyze.py）。
2. 设计：在 PR/说明中交代修改范围、影响面与回滚方案。
3. 验证：提供运行截图或日志（如 vLLM 端点可正常响应、示例脚本输出）。
4. 文档：必要时更新 README、示例或规则文件，保持信息同步。

---
如需我帮忙将以上内容存成 `project_rules.md` 等新文件，请告知。